<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8" />
    <title>Arbitrage Terminal â€“ Strategies</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { padding: 2rem; }
        .status-running { color: #28a745; font-weight: 600; }
        .status-stopped { color: #dc3545; font-weight: 600; }
        tbody tr:hover { background-color: #f8f9fa; }
    </style>
</head>
<body>
<h2 class="mb-4">Strategies</h2>
<table id="tbl-strategies" class="table table-sm table-striped align-middle">
    <thead>
    <tr>
        <th>ID</th>
        <th>Name</th>
        <th>Mode</th>
        <th>Spread&nbsp;Bid</th>
        <th>Spread&nbsp;Ask</th>
        <th>Pos&nbsp;Qty</th>
        <th>PNL</th>
        <th>Status</th>
        <th></th>
    </tr>
    </thead>
    <tbody>
    <!-- rows injected by JS -->
    </tbody>
</table>

<script src="https://cdn.jsdelivr.net/npm/axios@1.6.8/dist/axios.min.js"></script>
<script>
async function fetchStrategies() {
    const resp = await axios.get('/strategies');
    return resp.data; // object {id: {...}}
}

function fmt(val, digits=4){
    if (val===null || val===undefined) return '';
    return typeof val === 'number' ? val.toFixed(digits) : val;
}

function renderTable(data){
    const tbody = document.querySelector('#tbl-strategies tbody');
    tbody.innerHTML = '';
    Object.values(data).forEach(row => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
            <td>${row.strategy_id}</td>
            <td>${row.name || ''}</td>
            <td>${row.mode || ''}</td>
            <td>${fmt(row.spread_bid)}</td>
            <td>${fmt(row.spread_ask)}</td>
            <td>${row.position_qty ?? ''}</td>
            <td>${fmt(row.pnl,2)}</td>
            <td class="${row.running ? 'status-running' : 'status-stopped'}">${row.running ? 'RUNNING' : 'STOPPED'}</td>
            <td><button class="btn btn-sm btn-outline-danger" data-id="${row.strategy_id}">Stop</button></td>`;
        tbody.appendChild(tr);
    });
}

async function load(){
    const data = await fetchStrategies();
    renderTable(data);
}

load();
</script>
</body>
</html> 